import{r,j as e,H as C}from"./app-CUfu8rYq.js";import{U as M,n as _}from"./UserLayout-D_QpIzUd.js";import{T as E}from"./TextInput-deFth2lk.js";import{B as i}from"./Buton-CDYTW-AX.js";import{M as L}from"./Modal-D2T43NGV.js";import{C as O}from"./Card-CC3fp0GY.js";import{L as Y}from"./Loading-DtTTuKj4.js";import{s as b}from"./ChatCircle.es-TC_FV55H.js";import{s as B}from"./CheckCircle.es-CVYBrMmX.js";import{n as o}from"./Clock.es-WUXd4sta.js";import{m as R}from"./Question.es-96ucTMcF.js";import{s as $}from"./XCircle.es-BifiJGkl.js";import{u as q}from"./useTranslation-D0fAQNgG.js";import"./Logo-BXGbrpuT.js";import"./IconBase.es-CzJ_fMgf.js";import"./MagnifyingGlass.es-CoT4O1zZ.js";import"./User.es-U7lSCGfk.js";import"./X.es-D0_04aCK.js";const le=({auth:j})=>{const{t:A}=q(),[k,n]=r.useState(!1),[m,f]=r.useState([]),[N,w]=r.useState(!0),[a,c]=r.useState({subject:"",message:""}),[x,u]=r.useState(!1),[d,g]=r.useState({}),p=()=>{c({subject:"",message:""}),g({})},h=async()=>{try{const l=await(await fetch("/api/support/tickets",{credentials:"same-origin"})).json();l.success&&f(l.tickets)}catch(s){console.error("Destek istekleri yüklenirken hata:",s)}finally{w(!1)}};r.useEffect(()=>{h()},[]);const v=s=>{s.preventDefault(),u(!0);const l=document.querySelector('meta[name="csrf-token"]'),z=l?l.getAttribute("content"):"";fetch("/support",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":z},credentials:"same-origin",body:JSON.stringify({subject:a.subject,message:a.message})}).then(t=>t.json()).then(t=>{t.success?(n(!1),p(),h(),alert("Destek isteğiniz başarıyla gönderildi!")):(console.error("Destek isteği gönderilirken hata:",t),g(t.errors||{}))}).catch(t=>{console.error("Destek isteği gönderilirken hata:",t)}).finally(()=>{u(!1)})},y=()=>{p(),n(!0)},T=s=>{switch(s){case"open":return e.jsx(o,{className:"w-4 h-4 text-yellow-500"});case"closed":return e.jsx(B,{className:"w-4 h-4 text-green-500"});case"pending":return e.jsx($,{className:"w-4 h-4 text-red-500"});default:return e.jsx(o,{className:"w-4 h-4 text-gray-500"})}},S=s=>{switch(s){case"open":return"Açık";case"closed":return"Kapalı";case"pending":return"Beklemede";default:return"Bilinmiyor"}},D=s=>{switch(s){case"open":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";case"closed":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case"pending":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}};return e.jsxs(M,{auth:j,children:[e.jsx(C,{title:"Destek"}),e.jsxs("div",{className:"px-4 py-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Destek"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Sorun yaşıyorsanız destek ekibimizle iletişime geçin."})]}),e.jsxs(i,{className:"w-full md:w-auto mt-4",onClick:y,variant:"primary",children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"Yeni Destek İsteği"]})]}),e.jsx(O,{children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Destek İstekleriniz"}),N?e.jsx("div",{className:"text-center py-8",children:e.jsx(Y,{size:"lg",showText:!0,text:"Yükleniyor..."})}):m.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(R,{className:"w-12 h-12 text-gray-400 dark:text-gray-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Henüz destek isteğiniz bulunmuyor."}),e.jsx(i,{onClick:y,variant:"primary",children:"İlk Destek İsteğinizi Gönderin"})]}):e.jsx("div",{className:"space-y-4",children:m.map(s=>e.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[T(s.status),e.jsx("h3",{className:"font-medium text-gray-900 dark:text-white",children:s.subject})]}),e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${D(s.status)}`,children:S(s.status)})]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2 line-clamp-2",children:s.message}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500 dark:text-gray-400",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(o,{className:"w-3 h-3"}),e.jsx("span",{children:new Date(s.created_at).toLocaleDateString("tr-TR")})]}),s.admin_reply&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(b,{className:"w-3 h-3"}),e.jsx("span",{children:"Yanıtlandı"})]})]})]})}),s.admin_reply&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(b,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{className:"text-sm font-medium text-blue-900 dark:text-blue-200",children:"Admin Yanıtı"})]}),e.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-300",children:s.admin_reply}),s.replied_at&&e.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400 mt-2",children:new Date(s.replied_at).toLocaleDateString("tr-TR")})]})})]},s.id))})]})})]}),e.jsx(L,{isOpen:k,onClose:()=>n(!1),title:"Yeni Destek İsteği",maxWidth:"max-w-lg",children:e.jsxs("form",{onSubmit:v,className:"space-y-4",children:[e.jsx(E,{label:"Konu",value:a.subject,onChange:s=>c({...a,subject:s.target.value}),error:d.subject,placeholder:"Sorununuzun kısa açıklaması",required:!0}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Mesaj"}),e.jsx("textarea",{value:a.message,onChange:s=>c({...a,message:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg shadow-sm placeholder-gray-400 dark:placeholder-gray-500 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:focus:ring-blue-400 dark:focus:border-blue-400 resize-none",rows:5,placeholder:"Sorununuzu detaylı bir şekilde açıklayın...",required:!0}),d.message&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:d.message})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx(i,{type:"button",variant:"secondary",onClick:()=>n(!1),children:"İptal"}),e.jsx(i,{type:"submit",disabled:x,children:x?"Gönderiliyor...":"Gönder"})]})]})})]})};export{le as default};
