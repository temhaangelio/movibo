import{r as h,j as e,b as w,u as S,H as C}from"./app-DxVV8Q7s.js";import{U as R}from"./UserLayout-Bo4HhSwi.js";import{B as $}from"./Buton-Db9q6Vav.js";import{n as k}from"./Star.es-Dnjpd0Tz.js";import{L as E}from"./Loading-cXlLaGBN.js";import{n as L}from"./X.es-CnZplJjg.js";import{u as F}from"./useTranslation-BOFZMt0E.js";import"./Logo-CxtHgf6l.js";import"./IconBase.es-CBmXox22.js";import"./MagnifyingGlass.es-CmjxNXEe.js";import"./User.es-C5VCjUg2.js";const M=({value:l,onChange:i,label:u="Puanınız"})=>{const[t,o]=h.useState(0),p=s=>{i(s)};return e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:u}),e.jsxs("div",{className:"flex items-center space-x-1",children:[[1,2,3,4,5].map(s=>e.jsx("button",{type:"button",onClick:()=>p(s),onMouseEnter:()=>o(s),onMouseLeave:()=>o(0),className:"text-2xl transition-colors",children:e.jsx(k,{className:`w-8 h-8 ${s<=(t||l)?"text-black fill-current":"text-gray-300 dark:text-gray-600"}`,weight:s<=(t||l)?"fill":"regular"})},s)),l>0&&e.jsxs("span",{className:"ml-2 text-sm text-gray-600 dark:text-gray-400",children:[l,"/5"]})]})]})},z=({onMovieSelect:l,placeholder:i="Film adını yazın...",showSelectedMovie:u=!0,selectedMovie:t=null,onMovieDeselect:o=null,className:p=""})=>{const[s,c]=h.useState(""),[m,x]=h.useState([]),[b,y]=h.useState(!1),f=async r=>{if(!r.trim()){x([]);return}y(!0);try{const n=`/api/search/movies?query=${encodeURIComponent(r)}`,d=await(await fetch(n)).json();x(d.results?.slice(0,5)||[])}catch(n){console.error("Movie search error:",n),x([])}finally{y(!1)}},j=r=>{const n=r.target.value;c(n),n.trim()?f(n):x([])},v=r=>{l(r),x([]),c("")},N=()=>{o&&o()};return e.jsxs("div",{className:`relative ${p}`,children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:s,onChange:j,placeholder:i,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 dark:placeholder-gray-500 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:focus:ring-blue-400 dark:focus:border-blue-400"}),b&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx(E,{size:"sm"})})]}),m.length>0&&!t&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg z-50 max-h-60 overflow-y-auto",children:m.map(r=>e.jsx("button",{type:"button",onClick:()=>v(r),className:"w-full p-3 text-left hover:bg-gray-50 dark:hover:bg-gray-700 border-b border-gray-100 dark:border-gray-600 last:border-b-0",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:`https://image.tmdb.org/t/p/w92${r.poster_path}`,alt:r.title,className:"w-12 h-16 object-cover rounded",onError:n=>{n.target.src="https://via.placeholder.com/92x138?text=No+Image"}}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:r.title}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:r.release_date?.split("-")[0]}),r.vote_average&&e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(k,{className:"w-4 h-4 text-yellow-400 fill-current"}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-1",children:r.vote_average.toFixed(1)})]})]})]})},r.id))}),u&&t&&e.jsx("div",{className:"mt-3 bg-gray-100 dark:bg-blue-900/20 rounded-lg p-4 border border-gray-300 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:`https://image.tmdb.org/t/p/w92${t.poster_path}`,alt:t.title,className:"w-12 h-16 object-cover rounded",onError:r=>{r.target.src="https://via.placeholder.com/92x138?text=No+Image"}}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:t.title}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:t.release_date?.split("-")[0]}),t.vote_average&&e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(k,{className:"w-4 h-4 text-yellow-400 fill-current"}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-1",children:t.vote_average.toFixed(1)})]})]}),o&&e.jsx("button",{type:"button",onClick:N,className:"text-red-500 hover:text-red-700",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})]})},I=({onMovieSelect:l,selectedMovie:i,placeholder:u="Film adını yazın..."})=>e.jsx("div",{className:"mb-4",children:e.jsx(z,{onMovieSelect:l,selectedMovie:i,placeholder:u})}),G=({auth:l})=>{const{t:i}=F(),{props:u}=w(),[t,o]=h.useState(null),[p,s]=h.useState(0),{data:c,setData:m,post:x,processing:b,errors:y,reset:f}=S({content:"",media_type:"movie",media_id:"",media_title:"",media_description:"",media_poster:"",media_release_date:"",media_rating:"",media_genre:"",media_author:"",media_director:"",user_rating:""});h.useEffect(()=>{const a=new URLSearchParams(window.location.search),d=a.get("movie"),_=a.get("title");d&&_&&j(d)},[]);const j=async a=>{try{const _=await(await fetch(`/api/movies/${a}`)).json();if(_.success){const g=_.movie;o(g),m({content:"",media_type:"movie",media_id:g.id.toString(),media_title:g.title||"",media_description:g.overview||"",media_poster:g.poster_path||"",media_release_date:g.release_date||"",media_rating:g.vote_average?.toString()||"",media_genre:g.genres?.join(", ")||"",media_author:"",media_director:"",user_rating:""}),s(0)}}catch(d){console.error("Error fetching movie details:",d)}},v=a=>{s(a),m("user_rating",a.toString())},N=a=>{a.preventDefault(),x("/posts",{onSuccess:()=>{f(),o(null),s(0)}})},r=a=>{o(a),m({content:c.content,media_type:"movie",media_id:a.id.toString(),media_title:a.title||"",media_description:a.overview||"",media_poster:`https://image.tmdb.org/t/p/w500${a.poster_path}`,media_release_date:a.release_date||"",media_rating:a.vote_average?.toString()||"",media_genre:a.genre_ids?.join(", ")||"",media_author:"",media_director:"",user_rating:""}),s(0)},n=()=>{o(null),m({content:c.content,media_type:"movie",media_id:"",media_title:"",media_description:"",media_poster:"",media_release_date:"",media_rating:"",media_genre:"",media_author:"",media_director:"",user_rating:""}),s(0)};return e.jsxs(R,{auth:l,children:[e.jsx(C,{title:i("new_post","Yeni Paylaşım")}),e.jsx("div",{className:"w-full pt-4",children:e.jsxs("form",{onSubmit:N,className:"space-y-6",children:[!t&&e.jsx("div",{children:e.jsx(I,{onMovieSelect:r,selectedMovie:t})}),t&&e.jsxs("div",{className:"flex flex-col border border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 rounded-lg p-4",children:[e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"button",onClick:n,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",children:e.jsx(L,{className:"w-5 h-5"})})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[t.poster_path&&e.jsx("img",{src:`https://image.tmdb.org/t/p/w92${t.poster_path}`,alt:t.title,className:"w-16 h-24 object-cover rounded",onError:a=>{a.target.style.display="none"}}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900 dark:text-white",children:t.title}),t.release_date&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:new Date(t.release_date).getFullYear()}),t.vote_average&&e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["⭐ ",t.vote_average,"/10"]})]})]})]}),t&&e.jsx(M,{value:p,onChange:v,label:i("your_rating")}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:i("comment")}),e.jsx("textarea",{value:c.content,onChange:a=>{const d=a.target.value;d.length<=250&&m("content",d)},placeholder:i("comment_placeholder"),rows:4,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 dark:placeholder-gray-500 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-gray-500 dark:focus:ring-gray-400 dark:focus:border-gray-400"}),e.jsxs("div",{className:"flex justify-between items-center mt-1",children:[y.content&&e.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:y.content}),e.jsxs("p",{className:`text-sm ml-auto ${c.content.length>200?"text-red-500":"text-gray-500 dark:text-gray-400"}`,children:[c.content.length,"/250"]})]})]}),e.jsx("div",{className:"pt-4",children:e.jsx($,{type:"submit",disabled:b||!t,className:"w-full",size:"lg",children:b?i("sharing","Paylaşılıyor..."):i("share")})})]})})]})};export{G as default};
