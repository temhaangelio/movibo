import{r as a,j as e,H as C}from"./app-1CFGegWC.js";import{U as _,a as B,L as E,B as L}from"./UserLayout-BdK1clx9.js";import{T as O}from"./TextInput-C02hEDsl.js";import{B as i}from"./Buton-D5AuJqn0.js";import{C as M}from"./Card-BArZlIJg.js";import{s as f}from"./ChatCircle.es-DsYPXDwK.js";import{s as H}from"./CheckCircle.es-Dgdv_9V1.js";import{n as d}from"./Clock.es-DnADivhs.js";import{m as R}from"./Question.es-CoMpDBGK.js";import{s as Y}from"./XCircle.es-BeaMrH8l.js";import{u as $}from"./useTranslation-B6O3CaGH.js";import"./Logo-Bs4F9_8V.js";import"./IconBase.es-CROb1i5a.js";import"./MagnifyingGlass.es-B-Qxmdvq.js";import"./User.es-DyCkQSaU.js";const te=({auth:y})=>{const{t:q}=$(),[b,l]=a.useState(!1),[m,N]=a.useState([]),[k,v]=a.useState(!0),[r,c]=a.useState({subject:"",message:""}),[x,u]=a.useState(!1),[o,p]=a.useState({}),h=()=>{c({subject:"",message:""}),p({})},g=async()=>{try{const n=await(await fetch("/api/support/tickets",{credentials:"same-origin"})).json();n.success&&N(n.tickets)}catch(s){console.error("Destek istekleri yüklenirken hata:",s)}finally{v(!1)}};a.useEffect(()=>{g()},[]);const w=s=>{s.preventDefault(),u(!0);const n=document.querySelector('meta[name="csrf-token"]'),z=n?n.getAttribute("content"):"";fetch("/support",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":z},credentials:"same-origin",body:JSON.stringify({subject:r.subject,message:r.message})}).then(t=>t.json()).then(t=>{t.success?(l(!1),h(),g(),alert("Destek isteğiniz başarıyla gönderildi!")):(console.error("Destek isteği gönderilirken hata:",t),p(t.errors||{}))}).catch(t=>{console.error("Destek isteği gönderilirken hata:",t)}).finally(()=>{u(!1)})},j=()=>{h(),l(!0)},S=s=>{switch(s){case"open":return e.jsx(d,{className:"w-4 h-4 text-yellow-500"});case"closed":return e.jsx(H,{className:"w-4 h-4 text-green-500"});case"pending":return e.jsx(Y,{className:"w-4 h-4 text-red-500"});default:return e.jsx(d,{className:"w-4 h-4 text-gray-500"})}},T=s=>{switch(s){case"open":return"Açık";case"closed":return"Kapalı";case"pending":return"Beklemede";default:return"Bilinmiyor"}},D=s=>{switch(s){case"open":return"bg-yellow-100 text-yellow-800";case"closed":return"bg-green-100 text-green-800";case"pending":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs(_,{auth:y,children:[e.jsx(C,{title:"Destek"}),e.jsxs("div",{className:"px-4 py-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Destek"}),e.jsx("p",{className:"text-gray-600",children:"Sorun yaşıyorsanız destek ekibimizle iletişime geçin."})]}),e.jsxs(i,{className:"w-full md:w-auto mt-4",onClick:j,variant:"primary",children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),"Yeni Destek İsteği"]})]}),e.jsx(M,{children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Destek İstekleriniz"}),k?e.jsx("div",{className:"text-center py-8",children:e.jsx(E,{size:"lg"})}):m.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(R,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Henüz destek isteğiniz bulunmuyor."}),e.jsx(i,{onClick:j,variant:"primary",children:"İlk Destek İsteğinizi Gönderin"})]}):e.jsx("div",{className:"space-y-4",children:m.map(s=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[S(s.status),e.jsx("h3",{className:"font-medium text-gray-900",children:s.subject})]}),e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${D(s.status)}`,children:T(s.status)})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-2 line-clamp-2",children:s.message}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(d,{className:"w-3 h-3"}),e.jsx("span",{children:new Date(s.created_at).toLocaleDateString("tr-TR")})]}),s.admin_reply&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(f,{className:"w-3 h-3"}),e.jsx("span",{children:"Yanıtlandı"})]})]})]})}),s.admin_reply&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(f,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Admin Yanıtı"})]}),e.jsx("p",{className:"text-sm text-blue-800",children:s.admin_reply}),s.replied_at&&e.jsx("p",{className:"text-xs text-blue-600 mt-2",children:new Date(s.replied_at).toLocaleDateString("tr-TR")})]})})]},s.id))})]})})]}),e.jsx(L,{isOpen:b,onClose:()=>l(!1),title:"Yeni Destek İsteği",maxHeight:"max-h-[80vh]",children:e.jsxs("form",{onSubmit:w,className:"space-y-4",children:[e.jsx(O,{label:"Konu",value:r.subject,onChange:s=>c({...r,subject:s.target.value}),error:o.subject,placeholder:"Sorununuzun kısa açıklaması",required:!0}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mesaj"}),e.jsx("textarea",{value:r.message,onChange:s=>c({...r,message:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm placeholder-gray-400 bg-white text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",rows:5,placeholder:"Sorununuzu detaylı bir şekilde açıklayın...",required:!0}),o.message&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:o.message})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 sticky bottom-0 bg-white py-2",children:[e.jsx(i,{type:"button",variant:"secondary",onClick:()=>l(!1),children:"İptal"}),e.jsx(i,{type:"submit",disabled:x,children:x?"Gönderiliyor...":"Gönder"})]})]})})]})};export{te as default};
