import{r as a,j as e,H as I,L as G}from"./app-BMvav_zc.js";import{U as J}from"./UserLayout-BSPlcoB8.js";import{B as b}from"./Buton-CEvOLcIE.js";import{A as Q,P as V}from"./PostCard-BrCkwv6W.js";import{n as W}from"./Camera.es-BxYC3b8I.js";import{n as w}from"./User.es-yL24k2-q.js";import{n as z}from"./Users.es-C_3a5FXM.js";import{n as P}from"./X.es-5HcEANn4.js";import{u as Z}from"./useTranslation-CrVwURVX.js";import"./Logo-Dba2xN8V.js";import"./IconBase.es-DxRyOLx4.js";import"./MagnifyingGlass.es-DUHgy9I1.js";import"./TimeAgo-D2njuyMY.js";import"./Confirm-8Ptt6wEV.js";import"./Trash.es-CHgg6e9T.js";import"./Loading-BONqcUx1.js";import"./ChatCircle.es-CZWmnyGl.js";import"./Heart.es-CXkjtLRO.js";const ye=({auth:l,user:d,posts:x})=>{const{t:o}=Z(),[h,k]=a.useState(!1),[v,u]=a.useState(0),[N,p]=a.useState(0),[f,y]=a.useState(null),[F,j]=a.useState(null),[t,E]=a.useState(d),[c,m]=a.useState(!1),[g,n]=a.useState({open:!1,type:"success",message:""}),[L,S]=a.useState(!1),[B,C]=a.useState(!1),[_,A]=a.useState([]),[T,H]=a.useState([]),[O,U]=a.useState(!1),[R,$]=a.useState(!1);a.useEffect(()=>{l.user&&t&&l.user.id!==t.id?fetch(`/users/${t.id}/follow/check`).then(s=>s.json()).then(s=>{k(s.isFollowing),u(s.followersCount),p(s.followingCount)}):l.user&&l.user.id===t.id&&(u(t.followers_count||0),p(t.following_count||0))},[l.user,t]);const M=async()=>{if(!(!l.user||!t||l.user.id===t.id)){m(!0);try{const r=await(await fetch(`/users/${t.id}/follow`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}})).json();r.success?(k(r.isFollowing),u(r.followersCount),p(r.followingCount),n({open:!0,type:"success",message:r.message})):n({open:!0,type:"error",message:r.message||"Bir hata oluştu."})}catch(s){console.error("Follow error:",s),n({open:!0,type:"error",message:"Bir hata oluştu. Lütfen tekrar deneyin."})}finally{m(!1)}}},Y=async()=>{U(!0);try{const r=await(await fetch(`/users/${t.id}/followers`)).json();A(r.followers.data||[])}catch(s){console.error("Followers error:",s)}finally{U(!1)}},D=async()=>{$(!0);try{const r=await(await fetch(`/users/${t.id}/following`)).json();H(r.following.data||[])}catch(s){console.error("Following error:",s)}finally{$(!1)}},q=s=>{const r=s.target.files[0];if(r){y(r);const i=URL.createObjectURL(r);j(i)}},K=async()=>{if(f){m(!0);try{const s=new FormData;s.append("profile_photo",f);const r=await fetch("/profile/photo",{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:s});if(r.ok){const i=await r.json();m(!1),y(null),j(null),i.profile_photo&&E(X=>({...X,profile_photo:i.profile_photo})),n({open:!0,type:"success",message:"Profil fotoğrafı başarıyla güncellendi!"})}else{const i=await r.json().catch(()=>({}));throw new Error(i.message||"Upload failed")}}catch(s){console.error("Upload error:",s),m(!1),n({open:!0,type:"error",message:"Fotoğraf yüklenirken bir hata oluştu: "+s.message})}}};return e.jsxs(J,{auth:l,children:[e.jsx(I,{title:o("profile")}),e.jsx(Q,{open:g.open,type:g.type,message:g.message,onClose:()=>n({...g,open:!1})}),e.jsx("div",{className:"px-4 py-6",children:e.jsxs("div",{className:"grid grid-cols-1 gap-0",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 mb-6",children:[e.jsx("div",{className:"text-center mb-6",children:e.jsxs("div",{className:"relative inline-block",children:[e.jsxs("div",{className:"relative",children:[F?e.jsx("img",{src:F,alt:"Profil önizleme",className:"w-24 h-24 rounded-full object-cover mx-auto"}):t.profile_photo?e.jsx("img",{src:`/storage/${t.profile_photo}`,alt:"Profil fotoğrafı",className:"w-24 h-24 rounded-full object-cover mx-auto"}):e.jsx("div",{className:"w-24 h-24 bg-gray-300 dark:bg-gray-600 rounded-full flex items-center justify-center mx-auto",children:e.jsx(w,{className:"w-12 h-12 text-gray-600 dark:text-gray-400"})}),l.user&&l.user.id===d.id&&e.jsx("div",{className:"absolute bottom-0 right-0",children:e.jsxs("label",{className:"flex items-center justify-center bg-gray-900 dark:bg-gray-700 text-white p-2 rounded-full hover:bg-gray-800 dark:hover:bg-gray-600 transition-colors cursor-pointer",children:[e.jsx(W,{className:"w-4 h-4"}),e.jsx("input",{type:"file",accept:"image/*",onChange:q,className:"hidden"})]})})]}),f&&l.user&&l.user.id===d.id&&e.jsxs("div",{className:"mt-4 flex justify-center space-x-2",children:[e.jsx(b,{onClick:K,disabled:c,size:"sm",variant:"primary",children:c?o("uploading","Yükleniyor..."):o("save")}),e.jsx(b,{onClick:()=>{y(null),j(null)},size:"sm",variant:"secondary",children:o("cancel")})]})]})}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:d.name}),e.jsxs("p",{className:"text-gray-500 dark:text-gray-400 text-sm mb-4",children:["@",d.username||"user"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/50 rounded-lg p-2 transition-colors",onClick:()=>{S(!0),Y()},children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:v}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:o("followers")})]}),e.jsxs("div",{className:"text-center cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/50 rounded-lg p-2 transition-colors",onClick:()=>{C(!0),D()},children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:N}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:o("following")})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:x?.length||0}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:o("film")})]})]}),l.user&&l.user.id!==t.id&&e.jsx("div",{className:"mb-6",children:e.jsx("button",{onClick:M,disabled:c,className:`w-full px-4 py-3 rounded-full text-sm font-medium transition-all duration-200 flex items-center justify-center space-x-2 ${h?"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 text-red-600 dark:text-red-400 hover:bg-red-100 dark:hover:bg-red-900/30":"bg-blue-600 dark:bg-blue-500 text-white hover:bg-blue-700 dark:hover:bg-blue-600 shadow-sm hover:shadow-md"} ${c?"opacity-50 cursor-not-allowed":""}`,children:c?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:h?"Takip Bırakılıyor...":"Takip Ediliyor..."})]}):e.jsx(e.Fragment,{children:e.jsx("span",{children:h?"Takibi Bırak":"Takip Et"})})})})]})}),e.jsx("div",{className:"lg:col-span-2",children:e.jsx("div",{className:"space-y-4",children:x&&x.length>0?x.map(s=>e.jsx(V,{post:s,user:t,onLike:()=>{},onComment:()=>{}},s.id)):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Henüz paylaşım yapmamışsınız."}),e.jsx(G,{href:"/create",className:"mt-4 inline-block",children:e.jsx(b,{variant:"primary",size:"sm",children:"İlk Paylaşımınızı Yapın"})})]})})})]})}),L&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full max-h-96 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Takipçiler (",v,")"]}),e.jsx("button",{onClick:()=>S(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:e.jsx(P,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-4 overflow-y-auto max-h-80",children:O?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-6 h-6 border-2 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-2",children:"Yükleniyor..."})]}):_.length>0?e.jsx("div",{className:"space-y-3",children:_.map(s=>e.jsxs("div",{className:"flex items-center space-x-3 p-2 hover:bg-gray-50 dark:hover:bg-gray-700/50 rounded-lg",children:[e.jsx("div",{className:"flex-shrink-0",children:s.profile_photo?e.jsx("img",{src:`/storage/${s.profile_photo}`,alt:s.name,className:"w-10 h-10 rounded-full object-cover"}):e.jsx("div",{className:"w-10 h-10 bg-gray-300 dark:bg-gray-600 rounded-full flex items-center justify-center",children:e.jsx(w,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:s.name}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:["@",s.username]})]})]},s.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(z,{className:"w-12 h-12 text-gray-400 dark:text-gray-500 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Henüz takipçi yok"})]})})]})}),B&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full max-h-96 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:["Takip Edilenler (",N,")"]}),e.jsx("button",{onClick:()=>C(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:e.jsx(P,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"p-4 overflow-y-auto max-h-80",children:R?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-6 h-6 border-2 border-blue-600 border-t-transparent rounded-full animate-spin mx-auto"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-2",children:"Yükleniyor..."})]}):T.length>0?e.jsx("div",{className:"space-y-3",children:T.map(s=>e.jsxs("div",{className:"flex items-center space-x-3 p-2 hover:bg-gray-50 dark:hover:bg-gray-700/50 rounded-lg",children:[e.jsx("div",{className:"flex-shrink-0",children:s.profile_photo?e.jsx("img",{src:`/storage/${s.profile_photo}`,alt:s.name,className:"w-10 h-10 rounded-full object-cover"}):e.jsx("div",{className:"w-10 h-10 bg-gray-300 dark:bg-gray-600 rounded-full flex items-center justify-center",children:e.jsx(w,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:s.name}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 truncate",children:["@",s.username]})]})]},s.id))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(z,{className:"w-12 h-12 text-gray-400 dark:text-gray-500 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Henüz kimseyi takip etmiyor"})]})})]})})]})};export{ye as default};
